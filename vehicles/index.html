<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vehicles Specifications</title>
    <link rel="stylesheet" href="/assets/styles.css" />
</head>
<body>
<div class="container">
    
    <div class="header-top">
        <div class="logo">
            <a href="/">
                <strong style="color:var(--accent); font-size:1.4em;">MAHINDRA</strong> 
                <span style="font-size:1.1em; color:var(--text);">Internal Portal</span>
            </a>
        </div>
        <div class="header-utilities">
            <span style="color:var(--muted); font-size:14px;">Intended for employees</span>
            <button class="cta-request">Get Support</button>
            <button class="cta-chat">FAQs</button>
        </div>
    </div>
    
    <nav class="main-nav-bar">
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/vehicles/">Vehicles</a></li>
            <li><a href="/events/">Events</a></li>
            <li><a href="/templates/">Templates</a></li>
        </ul>
    </nav>
    
    <p class="breadcrumbs"><a href="/">Home</a> / <strong>Vehicles</strong></p>
    <h1 class="section-title">Vehicle Specifications & Resources</h1>
    
    <script id="base-url-script">
        const BASE_URL = "https://1drv.ms/x/c/f91e71cf4403fa00/IQQA-gNEz3EeIID5cRUAAAAAAR7fQiOle7HR3t1MOFjjYEE?em=2&wdAllowInteractivity=False&wdHideGridlines=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True";
    </script>

    <div class="tab-menu" id="vehicle-tabs">
        <button class="tab-button active" data-category="CAV" data-item="'CAV'!A1%3AD18">CAV</button>
        <button class="tab-button" data-category="APC" data-item="'APC'!A1%3AD24">APC</button>
        <button class="tab-button" data-category="ALSV-MRAP" data-item="'ALSV-MRAP'!A1%3AD6">ALSV-MRAP</button>
        <button class="tab-button" data-category="PICKUP" data-item="'Pickup'!A1%3AD12">PICKUPS</button>
        <button class="tab-button" data-category="CITV" data-item="'CITV'!A1%3AD15">CITV</button>
        <button class="tab-button" data-category="AMBULANCE" data-item="'Ambulance'!A1%3AD9">AMBULANCE</button>
        <button class="tab-button" data-category="BUS-VAN-TRUCK" data-item="'Bus-Van-Truck'!A1%3AD9">BUS-VAN-TRUCK</button>
        <button class="tab-button" data-category="INDUSTRIAL" data-item="'Industrial Vehicles'!A1%3AD10">INDUSTRIAL VEHICLES</button>
    </div>
    
    <div class="iframe-wrap iframe-loading" id="iframe-container">
        
        <div class="spinner"></div>

        <iframe  
            id="vehicle-iframe"
            /* Initial SRC for the CAV sheet */
            src="https://1drv.ms/x/c/f91e71cf4403fa00/IQQA-gNEz3EeIID5cRUAAAAAAR7fQiOle7HR3t1MOFjjYEE?em=2&wdAllowInteractivity=False&Item='CAV'!A1%3AD18&wdHideGridlines=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True" 
            frameborder="0"
            scrolling="yes"
            allowfullscreen
            style="position:absolute;inset:0;width:100%;height:100%;border:0;"
        ></iframe>
    </div>
    
    <div class="footer">
        © Mahindra Armored — Internal Use Only.<br>
        Unauthorized sharing prohibited. Responsibility for violations rests with the originating user.
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Retrieve the BASE_URL from the script tag with id="base-url-script"
        const baseScript = document.getElementById('base-url-script');
        const BASE_URL = baseScript ? baseScript.textContent.match(/BASE_URL\s*=\s*"(.*?)"/)[1] : null;

        const tabsContainer = document.getElementById('vehicle-tabs');
        const iframe = document.getElementById('vehicle-iframe');
        const iframeContainer = document.getElementById('iframe-container');
        
        if (!tabsContainer || !iframe || !iframeContainer || !BASE_URL) return; 

        // Function to handle loading state and source change
        function setIframeSource(itemParam, isInitialLoad = false) {
            // Show Spinner / Hide Iframe
            iframeContainer.classList.add('iframe-loading');
            iframeContainer.classList.remove('iframe-loaded');

            // Construct the full URL
            const newUrl = `${BASE_URL}&Item=${itemParam}`;
            
            // Update the iframe's source URL (triggers reload)
            iframe.src = newUrl;
        }

        // Event listener for tab clicks
        tabsContainer.addEventListener('click', function(event) {
            const button = event.target.closest('.tab-button');
            if (!button || button.classList.contains('active')) return; // Ignore if already active

            const itemParam = button.getAttribute('data-item');
            
            // 1. Trigger the loading state and source change
            setIframeSource(itemParam);

            // 2. Update active state for styling
            tabsContainer.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        });

        // Event listener for iframe LOAD COMPLETE
        iframe.onload = function() {
            // Hide Spinner / Show Iframe
            iframeContainer.classList.remove('iframe-loading');
            iframeContainer.classList.add('iframe-loaded');
        };
        
        // Note: The initial load is handled by the browser starting with the 
        // iframe src already set in the HTML. The onload event will fire once.
    });
</script>
</body>
</html>
