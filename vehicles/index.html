<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vehicles Specifications</title>
    <link rel="stylesheet" href="/assets/styles.css" />
    
    <script id="base-url-script">
        const BASE_URL = "https://1drv.ms/x/c/f91e71cf4403fa00/IQQA-gNEz3EeIID5cRUAAAAAAR7fQiOle7HR3t1MOFjjYEE?em=2&wdAllowInteractivity=False&wdHideGridlines=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True";
    </script>
    
    <style>
        .default-message {
            text-align: center;
            padding: 100px 20px;
            font-size: 1.2em;
            color: var(--muted);
            background-color: var(--card);
            border: 1px dashed #ccc;
            border-radius: 8px;
            margin-top: 20px;
        }
        /* Hides the default message once a tab has been clicked */
        .iframe-active .default-message {
            display: none;
        }
    </style>
</head>
<body>
<div class="container" id="main-container">
    
    <div class="header-top">
        <div class="logo">
            <a href="/">
                <strong style="color:var(--accent); font-size:1.4em;">MAHINDRA</strong> 
                <span style="font-size:1.1em; color:var(--text);">Internal Portal</span>
            </a>
        </div>
        <div class="header-utilities">
            <span style="color:var(--muted); font-size:14px;">Intended for employees</span>
            <button class="cta-request">Get Support</button>
            <button class="cta-chat">FAQs</button>
        </div>
    </div>
    <nav class="main-nav-bar">
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/vehicles/">Vehicles</a></li>
            <li><a href="/events/">Events</a></li>
            <li><a href="/templates/">Templates</a></li>
        </ul>
    </nav>
    
    <p class="breadcrumbs"><a href="/">Home</a> / <strong>Vehicles</strong></p>
    <h1 class="section-title">Vehicle Specifications & Resources</h1>
    
    <div class="tab-menu" id="vehicle-tabs">
        <button class="tab-button" data-category="CAV" data-item="'CAV'!A1%3AD18">CAV</button>
        <button class="tab-button" data-category="APC" data-item="'APC'!A1%3AD24">APC</button>
        <button class="tab-button" data-category="ALSV-MRAP" data-item="'ALSV-MRAP'!A1%3AD6">ALSV-MRAP</button>
        <button class="tab-button" data-category="PICKUP" data-item="'Pickup'!A1%3AD12">PICKUPS</button>
        <button class="tab-button" data-category="CITV" data-item="'CITV'!A1%3AD15">CITV</button>
        <button class="tab-button" data-category="AMBULANCE" data-item="'Ambulance'!A1%3AD9">AMBULANCE</button>
        <button class="tab-button" data-category="BUS-VAN-TRUCK" data-item="'Bus-Van-Truck'!A1%3AD9">BUS-VAN-TRUCK</button>
        <button class="tab-button" data-category="INDUSTRIAL" data-item="'Industrial Vehicles'!A1%3AD10">INDUSTRIAL VEHICLES</button>
    </div>
    
    <div class="iframe-wrap" id="iframe-container">
        
        <div class="spinner"></div>
        
        <div class="default-message">
            <p><strong>Select a vehicle category </strong></p>
        </div>

        <iframe  
            id="vehicle-iframe"
            src="" 
            frameborder="0"
            scrolling="yes"
            allowfullscreen
            style="position:absolute;inset:0;width:100%;height:100%;border:0;"
        ></iframe>
    </div>
    
    <div class="footer">
        © Mahindra Armored — Internal Use Only.<br>
        Unauthorized sharing prohibited. Responsibility for violations rests with the originating user.
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Retrieve BASE_URL
        const BASE_URL = document.getElementById('base-url-script').textContent.match(/BASE_URL\s*=\s*"(.*?)"/)[1];

        const tabsContainer = document.getElementById('vehicle-tabs');
        const iframe = document.getElementById('vehicle-iframe');
        const iframeContainer = document.getElementById('iframe-container');
        
        if (!tabsContainer || !iframe || !iframeContainer || !BASE_URL) return; 

        // Function to handle loading state and source change
        function setIframeSource(itemParam, button) {
            // 1. Hide the default message and show the iframe area
            iframeContainer.classList.add('iframe-active');

            // 2. Show Spinner / Hide Iframe (This starts the spinner animation)
            iframeContainer.classList.add('iframe-loading');
            iframeContainer.classList.remove('iframe-loaded');

            // 3. Construct the full URL
            const newUrl = `${BASE_URL}&Item=${itemParam}`;
            
            // 4. Update the iframe's source URL (triggers the browser to reload)
            iframe.src = newUrl;
        }

        // Event listener for tab clicks
        tabsContainer.addEventListener('click', function(event) {
            const button = event.target.closest('.tab-button');
            if (!button || button.classList.contains('active')) return;

            const itemParam = button.getAttribute('data-item');
            
            // Trigger the loading state and source change
            setIframeSource(itemParam, button);

            // Update active state for styling
            tabsContainer.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        });

        // Event listener for iframe LOAD COMPLETE
        iframe.onload = function() {
            // This stops the spinner and makes the iframe content visible
            iframeContainer.classList.remove('iframe-loading');
            iframeContainer.classList.add('iframe-loaded');
        };
    });
</script>
</body>
</html>
